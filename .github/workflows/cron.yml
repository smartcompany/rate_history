name: Hourly Cron Job

on:
  schedule:
    - cron: '10 * * * *'  # 매시 정각 실행 (UTC 기준)
  workflow_dispatch:      # 수동 실행도 가능하게 함

jobs:
  call-api:
    runs-on: ubuntu-latest
    steps:
      - name: Send monitoring API request
        run: |
          curl -X GET https://rate-history.vercel.app/api/monitoring
      
      - name: Update strategy (if needed)
        run: |
          # 일단 로컬 테스트용 - 실제 배포 후 올바른 URL로 변경 필요
          curl -X GET https://rate-history.vercel.app/api/analyze-strategy-cron \
            -H "Content-Type: application/json" \
            -H "User-Agent: github-actions-cron" \
            --fail-with-body || echo "Strategy API not available yet"
